<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Webpack"><meta name="keywords" content="Webpack"><meta name="author" content="XYX"><meta name="copyright" content="XYX"><title>Webpack | XYX's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?42b25629bbf1fae4313b2d989bcab163";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="XYX's Blog" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack五个核心概念"><span class="toc-number">1.</span> <span class="toc-text">webpack五个核心概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Webpack"><span class="toc-number">2.</span> <span class="toc-text">Webpack</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#初始化配置"><span class="toc-number">2.1.</span> <span class="toc-text">初始化配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编译打包应用"><span class="toc-number">2.2.</span> <span class="toc-text">编译打包应用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack开发环境配置"><span class="toc-number">3.</span> <span class="toc-text">webpack开发环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建配置文件"><span class="toc-number">3.1.</span> <span class="toc-text">创建配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#打包HTML资源"><span class="toc-number">3.2.</span> <span class="toc-text">打包HTML资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#打包图片资源"><span class="toc-number">3.3.</span> <span class="toc-text">打包图片资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#打包其他资源"><span class="toc-number">3.4.</span> <span class="toc-text">打包其他资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#devserver"><span class="toc-number">3.5.</span> <span class="toc-text">devserver</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开发环境配置"><span class="toc-number">3.6.</span> <span class="toc-text">开发环境配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack生产环境配置"><span class="toc-number">4.</span> <span class="toc-text">webpack生产环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#提取js中的css成单独文件"><span class="toc-number">4.1.</span> <span class="toc-text">提取js中的css成单独文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#css兼容性处理"><span class="toc-number">4.2.</span> <span class="toc-text">css兼容性处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#压缩css"><span class="toc-number">4.3.</span> <span class="toc-text">压缩css</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js语法检查"><span class="toc-number">4.4.</span> <span class="toc-text">js语法检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js兼容性处理"><span class="toc-number">4.5.</span> <span class="toc-text">js兼容性处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js压缩"><span class="toc-number">4.6.</span> <span class="toc-text">js压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#html压缩"><span class="toc-number">4.7.</span> <span class="toc-text">html压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#生产环境配置"><span class="toc-number">4.8.</span> <span class="toc-text">生产环境配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack优化环境配置"><span class="toc-number">5.</span> <span class="toc-text">webpack优化环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#HMR"><span class="toc-number">5.1.</span> <span class="toc-text">HMR</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#source-map"><span class="toc-number">5.2.</span> <span class="toc-text">source-map</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oneof"><span class="toc-number">5.3.</span> <span class="toc-text">oneof</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#缓存"><span class="toc-number">5.4.</span> <span class="toc-text">缓存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tree-shaking"><span class="toc-number">5.5.</span> <span class="toc-text">tree shaking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#code-split"><span class="toc-number">5.6.</span> <span class="toc-text">code split</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#懒加载和预加载"><span class="toc-number">5.7.</span> <span class="toc-text">懒加载和预加载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwa"><span class="toc-number">5.8.</span> <span class="toc-text">pwa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多进程打包"><span class="toc-number">5.9.</span> <span class="toc-text">多进程打包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#externals"><span class="toc-number">5.10.</span> <span class="toc-text">externals</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dll"><span class="toc-number">5.11.</span> <span class="toc-text">dll</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack配置详解"><span class="toc-number">6.</span> <span class="toc-text">webpack配置详解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#entry"><span class="toc-number">6.1.</span> <span class="toc-text">entry</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#output"><span class="toc-number">6.2.</span> <span class="toc-text">output</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#module"><span class="toc-number">6.3.</span> <span class="toc-text">module</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#resolve"><span class="toc-number">6.4.</span> <span class="toc-text">resolve</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dev-server"><span class="toc-number">6.5.</span> <span class="toc-text">dev server</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#optimization"><span class="toc-number">6.6.</span> <span class="toc-text">optimization</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack5（正在开发中-71-）"><span class="toc-number">7.</span> <span class="toc-text">webpack5（正在开发中 71%）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#下载"><span class="toc-number">7.1.</span> <span class="toc-text">下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自动删除-Node-js-Polyfills"><span class="toc-number">7.2.</span> <span class="toc-text">自动删除 Node.js Polyfills</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Chunk-和模块-ID"><span class="toc-number">7.3.</span> <span class="toc-text">Chunk 和模块 ID</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Chunk-ID"><span class="toc-number">7.4.</span> <span class="toc-text">Chunk ID</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tree-Shaking"><span class="toc-number">7.5.</span> <span class="toc-text">Tree Shaking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Output"><span class="toc-number">7.6.</span> <span class="toc-text">Output</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SplitChunk"><span class="toc-number">7.7.</span> <span class="toc-text">SplitChunk</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Caching"><span class="toc-number">7.8.</span> <span class="toc-text">Caching</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#监视输出文件"><span class="toc-number">7.9.</span> <span class="toc-text">监视输出文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#默认值"><span class="toc-number">7.10.</span> <span class="toc-text">默认值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更多内容"><span class="toc-number">7.11.</span> <span class="toc-text">更多内容</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">XYX</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">26</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">28</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">11</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">我的朋友们</div><a class="author-info-links__name text-center" href="https://www.ntutn.top/" target="_blank" rel="noopener">归零幻想</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1606218892799&amp;di=ab820794d4e4cdd390b3a7a2d01c0cc7&amp;imgtype=0&amp;src=http%3A%2F%2Fattachments.gfan.com%2Fforum%2F201504%2F06%2F0638202b7ws2d2w4bzsyuu.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">XYX's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">首页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title">Webpack</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-07-18</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/">自动化构建工具</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">10.7k</span><span class="post-meta__separator">|</span><span>阅读时长: 50 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><blockquote>
<p>序<br><br>webpack是一种前端资源构建工具，一个静态模块打包器(modulebundler)<br><br>在webpack看来,前端的所有资源文件(js/json/css/img/less/…)都会作为模块处理<br><br>它将根据模块的依赖关系进行静态分析，打包生成对应的静态资源(bundle)<br></p>
</blockquote>
<a id="more"></a>
<p><img src="/2020/07/18/Webpack/1.png" alt></p>
<h1 id="webpack五个核心概念"><a href="#webpack五个核心概念" class="headerlink" title="webpack五个核心概念"></a>webpack五个核心概念</h1><ol>
<li>Entry<ul>
<li>入口(Entry)指示webpack以哪个文件为入口起点开始打包，分析构建内部依赖图</li>
</ul>
</li>
<li>Output<ul>
<li>输出(Output)指示webpack打包后的资源bundles输出到哪里去，以及如何命名</li>
</ul>
</li>
<li>Loader<ul>
<li>Loader让webpack能够去处理那些非JavaScript文件(webpack自身只理解JavaScript)</li>
</ul>
</li>
<li>Plugins<ul>
<li>插件(Plugins)可以用于执行范围更广的任务。插件的范围包括，从打包优化和压缩，一直到重新定义环境中的变量等</li>
</ul>
</li>
<li>Mode<ul>
<li>模式(Mode)指示webpack使用相应模式的配置<br><img src="/2020/07/18/Webpack/mode.png" alt></li>
</ul>
</li>
</ol>
<h1 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h1><h2 id="初始化配置"><a href="#初始化配置" class="headerlink" title="初始化配置"></a>初始化配置</h2><ol>
<li>初始化package.json<ul>
<li>输入指令:npminit</li>
</ul>
</li>
</ol>
<p>2.下载并安装webpack</p>
<ul>
<li>输入指令：<ul>
<li>npm install webpack webpack-cli -g //全局安装</li>
<li>npm install webpack webpack-cli -D </li>
</ul>
</li>
</ul>
<h2 id="编译打包应用"><a href="#编译打包应用" class="headerlink" title="编译打包应用"></a>编译打包应用</h2><ul>
<li>开发环境：webpack ./src/index.js -o ./build/built.js –mode=development<ul>
<li>webpack会以 ./src/index.js 为入口文件开始打包，打包后输出到 ./build/built.js 整体打包环境是开发环境</li>
<li>功能：webpack能够编译打包js和json文件，并且能将es6的模块化语法转换成浏览器能识别的语法</li>
</ul>
</li>
<li>生产环境：webpack ./src/index.js -o ./build/built.js –mode=production<ul>
<li>webpack会以 ./src/index.js 为入口文件开始打包，打包后输出到 ./build/built.js，整体打包环境是生产环境</li>
<li>功能：在开发配置功能上多一个功能，压缩代码</li>
</ul>
</li>
</ul>
<h1 id="webpack开发环境配置"><a href="#webpack开发环境配置" class="headerlink" title="webpack开发环境配置"></a>webpack开发环境配置</h1><h2 id="创建配置文件"><a href="#创建配置文件" class="headerlink" title="创建配置文件"></a>创建配置文件</h2><ul>
<li>webpack.config.js  <ul>
<li>webpack的配置文件</li>
<li>作用: 指示 webpack 干哪些活（当你运行 webpack 指令时，会加载里面的配置）</li>
<li>所有构建工具都是基于nodejs平台运行的~模块化默认采用commonjs<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; resolve用来拼接绝对路径的方法</span><br><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">&#x2F;&#x2F; webpack配置</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 入口起点</span><br><span class="line">entry: &#39;.&#x2F;src&#x2F;index.js&#39;,</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 输出</span><br><span class="line">output: &#123;</span><br><span class="line">    &#x2F;&#x2F; 输出文件名</span><br><span class="line">    filename: &#39;built.js&#39;,</span><br><span class="line">    &#x2F;&#x2F; 输出路径</span><br><span class="line">    &#x2F;&#x2F; __dirname nodejs的变量，代表当前文件的目录绝对路径</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; loader的配置</span><br><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">    &#x2F;&#x2F; 详细loader配置</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 举例</span><br><span class="line">    &#x2F;&#x2F; 不同文件必须配置不同loader处理</span><br><span class="line">  &#123;</span><br><span class="line">    &#x2F;&#x2F; 匹配.css后缀的文件</span><br><span class="line">    test: &#x2F;\.css$&#x2F;,</span><br><span class="line">    &#x2F;&#x2F; 使用哪些loader进行处理</span><br><span class="line">    use: [</span><br><span class="line">      &#x2F;&#x2F; use数组中loader执行顺序：从右到左，从下到上 依次执行</span><br><span class="line">      &#x2F;&#x2F; 创建style标签，将js中的样式资源插入进行，添加到head中生效</span><br><span class="line">      &#39;style-loader&#39;,</span><br><span class="line">      &#x2F;&#x2F; 将css文件变成commonjs模块加载js中，里面内容是样式字符串</span><br><span class="line">      &#39;css-loader&#39;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    &#x2F;&#x2F; 匹配.less后缀的文件  </span><br><span class="line">    test: &#x2F;\.less$&#x2F;,</span><br><span class="line">    use: [</span><br><span class="line">      &#39;style-loader&#39;,</span><br><span class="line">      &#39;css-loader&#39;,</span><br><span class="line">      &#x2F;&#x2F; 将less文件编译成css文件</span><br><span class="line">      &#x2F;&#x2F; 需要下载 less-loader和less</span><br><span class="line">      &#39;less-loader&#39;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; plugins的配置</span><br><span class="line">plugins: [</span><br><span class="line">    &#x2F;&#x2F; 详细plugins的配置</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 模式</span><br><span class="line">mode: &#39;development&#39;, &#x2F;&#x2F; 开发模式</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>运行指令：webpack</li>
</ul>
<h2 id="打包HTML资源"><a href="#打包HTML资源" class="headerlink" title="打包HTML资源"></a>打包HTML资源</h2><ol>
<li>下载安装plugin包<ul>
<li>npm install –save-dev html -webpack-plugin</li>
</ul>
</li>
<li>修改配置文件 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">entry: &#39;.&#x2F;src&#x2F;index.js&#39;,</span><br><span class="line">output: &#123;</span><br><span class="line">    filename: &#39;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">&#125;,</span><br><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">    &#x2F;&#x2F; loader的配置</span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br><span class="line">plugins: [</span><br><span class="line">    &#x2F;&#x2F; plugins的配置</span><br><span class="line">    &#x2F;&#x2F; html-webpack-plugin</span><br><span class="line">    &#x2F;&#x2F; 功能：默认会创建一个空的HTML，自动引入打包输出的所有资源（JS&#x2F;CSS）</span><br><span class="line">    &#x2F;&#x2F; 需求：需要有结构的HTML文件</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">    &#x2F;&#x2F; 复制 &#39;.&#x2F;src&#x2F;index.html&#39; 文件，并自动引入打包输出的所有资源（JS&#x2F;CSS）</span><br><span class="line">    template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">],</span><br><span class="line">mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="打包图片资源"><a href="#打包图片资源" class="headerlink" title="打包图片资源"></a>打包图片资源</h2><ol>
<li>下载安装loader包<ul>
<li>npm install –save-dev html-loader url-loader file-loader</li>
</ul>
</li>
<li>修改配置文件 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">entry: &#39;.&#x2F;src&#x2F;index.js&#39;,</span><br><span class="line">output: &#123;</span><br><span class="line">    filename: &#39;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">&#125;,</span><br><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">    &#123;</span><br><span class="line">        test: &#x2F;\.less$&#x2F;,</span><br><span class="line">        &#x2F;&#x2F; 要使用多个loader处理用use</span><br><span class="line">        use: [&#39;style-loader&#39;, &#39;css-loader&#39;, &#39;less-loader&#39;]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; 问题：默认处理不了html中img图片</span><br><span class="line">        &#x2F;&#x2F; 处理图片资源</span><br><span class="line">        test: &#x2F;\.(jpg|png|gif)$&#x2F;,</span><br><span class="line">        &#x2F;&#x2F; 使用一个loader</span><br><span class="line">        &#x2F;&#x2F; 下载 url-loader file-loader</span><br><span class="line"></span><br><span class="line">        loader: &#39;url-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">        limit: 8 * 1024,</span><br><span class="line">        &#x2F;&#x2F; 图片小于8kb，就会被base64处理</span><br><span class="line">        &#x2F;&#x2F; 优点: 减少请求数量（减轻服务器压力）</span><br><span class="line">        &#x2F;&#x2F; 缺点：图片体积会更大（文件请求速度更慢）</span><br><span class="line">        &#x2F;&#x2F; base64在本地解码，所以会减少服务器压力，如果图片过大还继续采用base64编码会导致cpu调用率上升，网页加载时变卡</span><br><span class="line">       </span><br><span class="line">        &#x2F;&#x2F; 问题：因为url-loader默认使用es6模块化解析，而html-loader引入图片是commonjs</span><br><span class="line">        &#x2F;&#x2F; 解析时会出问题：[object Module]</span><br><span class="line">        &#x2F;&#x2F; 解决：关闭url-loader的es6模块化，使用commonjs解析</span><br><span class="line">        esModule: false,</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 给图片进行重命名</span><br><span class="line">        &#x2F;&#x2F; [hash:10]取图片的hash的前10位</span><br><span class="line">        &#x2F;&#x2F; [ext]取文件原来扩展名</span><br><span class="line">        name: &#39;[hash:10].[ext]&#39;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        test: &#x2F;\.html$&#x2F;,</span><br><span class="line">        &#x2F;&#x2F; 处理html文件的img图片（负责引入img，从而能被url-loader进行处理）</span><br><span class="line">        loader: &#39;html-loader&#39;</span><br><span class="line">    &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br><span class="line">plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">    template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">],</span><br><span class="line">mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="打包其他资源"><a href="#打包其他资源" class="headerlink" title="打包其他资源"></a>打包其他资源</h2><ol>
<li>修改配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.css$&#x2F;,</span><br><span class="line">        use: [&#39;style-loader&#39;, &#39;css-loader&#39;]</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      &#x2F;&#x2F; 打包其他资源(除了html&#x2F;js&#x2F;css资源以外的资源)</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 排除css&#x2F;js&#x2F;html资源，剩下的资源用file loader进行处理</span><br><span class="line">        exclude: &#x2F;\.(css|js|html|less)$&#x2F;,</span><br><span class="line">        loader: &#39;file-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          name: &#39;[hash:10].[ext]&#39;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="devserver"><a href="#devserver" class="headerlink" title="devserver"></a>devserver</h2><ul>
<li>开发服务器 devServer：用来自动化（自动编译，自动打开浏览器，自动刷新浏览器~~）</li>
<li>特点：只会在内存中编译打包，不会有任何输出</li>
<li>下载：npm install webpack-dev-server -D //本地下载</li>
<li>启动devServer指令为：npx webpack-dev-server</li>
</ul>
<ol>
<li>修改配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.css$&#x2F;,</span><br><span class="line">        use: [&#39;style-loader&#39;, &#39;css-loader&#39;]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#x2F;&#x2F; 打包其他资源(除了html&#x2F;js&#x2F;css资源以外的资源)</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 排除css&#x2F;js&#x2F;html资源</span><br><span class="line">        exclude: &#x2F;\.(css|js|html|less)$&#x2F;,</span><br><span class="line">        loader: &#39;file-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          name: &#39;[hash:10].[ext]&#39;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;development&#39;,</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">  devServer: &#123;</span><br><span class="line">    &#x2F;&#x2F; 项目构建后路径</span><br><span class="line">    contentBase: resolve(__dirname, &#39;build&#39;),</span><br><span class="line">    &#x2F;&#x2F; 启动gzip压缩</span><br><span class="line">    compress: true,</span><br><span class="line">    &#x2F;&#x2F; 端口号</span><br><span class="line">    port: 3000,</span><br><span class="line">    &#x2F;&#x2F; 自动打开浏览器</span><br><span class="line">    open: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令:npx webpack-dev-server</li>
</ol>
<h2 id="开发环境配置"><a href="#开发环境配置" class="headerlink" title="开发环境配置"></a>开发环境配置</h2><ul>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">  开发环境配置：能让代码运行</span><br><span class="line">    运行项目指令：</span><br><span class="line">      webpack 会将打包结果输出出去</span><br><span class="line">      npx webpack-dev-server 只会在内存中编译打包，没有输出</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#x2F;&#x2F; loader的配置</span><br><span class="line"></span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 处理less资源</span><br><span class="line">        test: &#x2F;\.less$&#x2F;,</span><br><span class="line">        use: [&#39;style-loader&#39;, &#39;css-loader&#39;, &#39;less-loader&#39;]</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 处理css资源</span><br><span class="line">        test: &#x2F;\.css$&#x2F;,</span><br><span class="line">        use: [&#39;style-loader&#39;, &#39;css-loader&#39;]</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 处理图片资源</span><br><span class="line">        test: &#x2F;\.(jpg|png|gif)$&#x2F;,</span><br><span class="line">        loader: &#39;url-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: 8 * 1024,</span><br><span class="line">          name: &#39;[hash:10].[ext]&#39;,</span><br><span class="line">          &#x2F;&#x2F; 关闭es6模块化</span><br><span class="line">          esModule: false,</span><br><span class="line">          outputPath: &#39;imgs&#39;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 处理html中img资源</span><br><span class="line">        test: &#x2F;\.html$&#x2F;,</span><br><span class="line">        loader: &#39;html-loader&#39;</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 处理其他资源</span><br><span class="line">        exclude: &#x2F;\.(html|js|css|less|jpg|png|gif)&#x2F;,</span><br><span class="line">        loader: &#39;file-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          name: &#39;[hash:10].[ext]&#39;,</span><br><span class="line">          outputPath: &#39;media&#39;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  plugins: [</span><br><span class="line">    &#x2F;&#x2F; plugins的配置</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  mode: &#39;development&#39;,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: resolve(__dirname, &#39;build&#39;),</span><br><span class="line">    compress: true,</span><br><span class="line">    port: 3000,</span><br><span class="line">    open: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="webpack生产环境配置"><a href="#webpack生产环境配置" class="headerlink" title="webpack生产环境配置"></a>webpack生产环境配置</h1><h2 id="提取js中的css成单独文件"><a href="#提取js中的css成单独文件" class="headerlink" title="提取js中的css成单独文件"></a>提取js中的css成单独文件</h2><ol>
<li>下载插件<ul>
<li>npm install –save-dev mini-css-extract-plugin</li>
</ul>
</li>
<li>修改配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line">const MiniCssExtractPlugin &#x3D; require(&#39;mini-css-extract-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.css$&#x2F;,</span><br><span class="line">        use: [</span><br><span class="line">          &#x2F;&#x2F; 创建style标签，将样式放入</span><br><span class="line">          &#x2F;&#x2F; &#39;style-loader&#39;, </span><br><span class="line">          &#x2F;&#x2F; 这个loader取代style-loader。作用：提取js中的css成单独文件</span><br><span class="line">          MiniCssExtractPlugin.loader,</span><br><span class="line">          &#x2F;&#x2F; 将css文件整合到js文件中</span><br><span class="line">          &#39;css-loader&#39;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;),</span><br><span class="line">    new MiniCssExtractPlugin(&#123;</span><br><span class="line">      &#x2F;&#x2F; 对输出的css文件进行重命名</span><br><span class="line">      filename: &#39;css&#x2F;built.css&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="css兼容性处理"><a href="#css兼容性处理" class="headerlink" title="css兼容性处理"></a>css兼容性处理</h2><ol>
<li>下载loader<ul>
<li>npm install –save-dev postcss-loader postcss-preset-env</li>
</ul>
</li>
<li>修改配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line">const MiniCssExtractPlugin &#x3D; require(&#39;mini-css-extract-plugin&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 设置nodejs环境变量</span><br><span class="line">&#x2F;&#x2F; process.env.NODE_ENV &#x3D; &#39;development&#39;;</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.css$&#x2F;,</span><br><span class="line">        use: [</span><br><span class="line">          MiniCssExtractPlugin.loader,</span><br><span class="line">          &#39;css-loader&#39;,</span><br><span class="line"></span><br><span class="line">          &#x2F;*</span><br><span class="line">            css兼容性处理：postcss --&gt; postcss-loader postcss-preset-env</span><br><span class="line"></span><br><span class="line">            帮postcss找到package.json中browserslist里面的配置，通过配置加载指定的css兼容性样式</span><br><span class="line"></span><br><span class="line">            在package.json中添加：</span><br><span class="line">            &quot;browserslist&quot;: &#123;</span><br><span class="line">              &#x2F;&#x2F; 转换到开发环境 --&gt; 设置node环境变量：process.env.NODE_ENV &#x3D; development</span><br><span class="line">              &quot;development&quot;: [</span><br><span class="line">                &quot;last 1 chrome version&quot;,</span><br><span class="line">                &quot;last 1 firefox version&quot;,</span><br><span class="line">                &quot;last 1 safari version&quot;</span><br><span class="line">              ],</span><br><span class="line">              &#x2F;&#x2F; 生产环境：默认是看生产环境</span><br><span class="line">              &quot;production&quot;: [</span><br><span class="line">                &quot;&gt;0.2%&quot;,  兼容大于99.8%的浏览器</span><br><span class="line">                &quot;not dead&quot;, 不用已经消失的浏览器</span><br><span class="line">                &quot;not op_mini all&quot; 不用op_mini浏览器</span><br><span class="line">              ]</span><br><span class="line">            &#125;</span><br><span class="line">          *&#x2F;</span><br><span class="line"></span><br><span class="line">          &#x2F;&#x2F; 使用loader的默认配置</span><br><span class="line">          &#x2F;&#x2F; &#39;postcss-loader&#39;,</span><br><span class="line">          &#x2F;&#x2F; 修改loader的配置</span><br><span class="line">          &#123;</span><br><span class="line">            loader: &#39;postcss-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              ident: &#39;postcss&#39;,</span><br><span class="line">              plugins: () &#x3D;&gt; [</span><br><span class="line">                &#x2F;&#x2F; postcss的插件</span><br><span class="line">                require(&#39;postcss-preset-env&#39;)()</span><br><span class="line">              ]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;),</span><br><span class="line">    new MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: &#39;css&#x2F;built.css&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>修改package.json<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">在package.json中添加：</span><br><span class="line">&quot;browserslist&quot;: &#123;</span><br><span class="line">    &#x2F;&#x2F; 转换到开发环境 --&gt; 设置node环境变量：process.env.NODE_ENV &#x3D; development</span><br><span class="line">    &quot;development&quot;: [</span><br><span class="line">    &quot;last 1 chrome version&quot;,</span><br><span class="line">    &quot;last 1 firefox version&quot;,</span><br><span class="line">    &quot;last 1 safari version&quot;</span><br><span class="line">    ],</span><br><span class="line">    &#x2F;&#x2F; 生产环境：默认是看生产环境</span><br><span class="line">    &quot;production&quot;: [</span><br><span class="line">    &quot;&gt;0.2%&quot;,  兼容大于99.8%的浏览器</span><br><span class="line">    &quot;not dead&quot;, 不用已经消失的浏览器</span><br><span class="line">    &quot;not op_mini all&quot; 不用op_mini浏览器</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="压缩css"><a href="#压缩css" class="headerlink" title="压缩css"></a>压缩css</h2><ol>
<li>下载安装包<ul>
<li>npm install –save-dev optimize-css-assets-webpack-plugin</li>
</ul>
</li>
<li>修改配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line">const MiniCssExtractPlugin &#x3D; require(&#39;mini-css-extract-plugin&#39;);</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin &#x3D; require(&#39;optimize-css-assets-webpack-plugin&#39;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 设置nodejs环境变量</span><br><span class="line">&#x2F;&#x2F; process.env.NODE_ENV &#x3D; &#39;development&#39;;</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.css$&#x2F;,</span><br><span class="line">        use: [</span><br><span class="line">          MiniCssExtractPlugin.loader,</span><br><span class="line">          &#39;css-loader&#39;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: &#39;postcss-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              ident: &#39;postcss&#39;,</span><br><span class="line">              plugins: () &#x3D;&gt; [</span><br><span class="line">                &#x2F;&#x2F; postcss的插件</span><br><span class="line">                require(&#39;postcss-preset-env&#39;)()</span><br><span class="line">              ]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;),</span><br><span class="line">    new MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: &#39;css&#x2F;built.css&#39;</span><br><span class="line">    &#125;),</span><br><span class="line">    &#x2F;&#x2F; 压缩css</span><br><span class="line">    new OptimizeCssAssetsWebpackPlugin()</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="js语法检查"><a href="#js语法检查" class="headerlink" title="js语法检查"></a>js语法检查</h2><ol>
<li>下载安装包<ul>
<li>npm install –save-dev eslint-loader eslint  eslint-config-airbnb-base eslint-plugin-import</li>
</ul>
</li>
<li>修改配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#x2F;*</span><br><span class="line">        语法检查： eslint-loader  eslint</span><br><span class="line">          注意：只检查自己写的源代码，第三方的库是不用检查的</span><br><span class="line">          设置检查规则：</span><br><span class="line">            package.json中eslintConfig中设置~</span><br><span class="line">              &quot;eslintConfig&quot;: &#123;</span><br><span class="line">                &quot;extends&quot;: &quot;airbnb-base&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            airbnb --&gt; eslint-config-airbnb-base  eslint-plugin-import eslint</span><br><span class="line">      *&#x2F;</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.js$&#x2F;,</span><br><span class="line">        exclude: &#x2F;node_modules&#x2F;, &#x2F;&#x2F;排除node_modules</span><br><span class="line">        loader: &#39;eslint-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          &#x2F;&#x2F; 自动修复eslint的错误</span><br><span class="line">          fix: true</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>修改package.json<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">设置检查规则：</span><br><span class="line">&#x2F;&#x2F;package.json中eslintConfig中设置~</span><br><span class="line">    &quot;eslintConfig&quot;: &#123;</span><br><span class="line">    &quot;extends&quot;: &quot;airbnb-base&quot;,&#x2F;&#x2F;使用airbnb-base的代码风格</span><br><span class="line">    &quot;env&quot;: &#123;</span><br><span class="line">      &quot;browser&quot;: true</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>


</li>
</ol>
<h2 id="js兼容性处理"><a href="#js兼容性处理" class="headerlink" title="js兼容性处理"></a>js兼容性处理</h2><ol>
<li>下载安装包<ul>
<li>npm install –save-dev babel-loader @babel/core @babel/preset-env @babel/polyfill core-js</li>
</ul>
</li>
<li>修改配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#x2F;*</span><br><span class="line">        js兼容性处理：babel-loader @babel&#x2F;core </span><br><span class="line">          1. 基本js兼容性处理 --&gt; @babel&#x2F;preset-env</span><br><span class="line">            问题：只能转换基本语法，如promise高级语法不能转换</span><br><span class="line">          2. 全部js兼容性处理 --&gt; @babel&#x2F;polyfill  </span><br><span class="line">            问题：我只要解决部分兼容性问题，但是将所有兼容性代码全部引入，体积太大了~</span><br><span class="line">          3. 需要做兼容性处理的就做：按需加载  --&gt; core-js</span><br><span class="line">      *&#x2F;  </span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.js$&#x2F;,</span><br><span class="line">        exclude: &#x2F;node_modules&#x2F;,</span><br><span class="line">        loader: &#39;babel-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          &#x2F;&#x2F; 预设：指示babel做怎么样的兼容性处理</span><br><span class="line">          presets: [</span><br><span class="line">            [</span><br><span class="line">              &#39;@babel&#x2F;preset-env&#39;,</span><br><span class="line">              &#123;</span><br><span class="line">                &#x2F;&#x2F; 按需加载</span><br><span class="line">                useBuiltIns: &#39;usage&#39;,</span><br><span class="line"></span><br><span class="line">                &#x2F;&#x2F; 指定core-js版本</span><br><span class="line">                corejs: &#123;</span><br><span class="line">                  version: 3</span><br><span class="line">                &#125;,</span><br><span class="line"></span><br><span class="line">                &#x2F;&#x2F; 指定兼容性做到哪个版本浏览器</span><br><span class="line">                targets: &#123;</span><br><span class="line">                  chrome: &#39;60&#39;,</span><br><span class="line">                  firefox: &#39;60&#39;,</span><br><span class="line">                  ie: &#39;9&#39;,</span><br><span class="line">                  safari: &#39;10&#39;,</span><br><span class="line">                  edge: &#39;17&#39;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="js压缩"><a href="#js压缩" class="headerlink" title="js压缩"></a>js压缩</h2><ol>
<li>修改配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  &#x2F;&#x2F; 生产环境下会自动压缩js代码</span><br><span class="line">  mode: &#39;production&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="html压缩"><a href="#html压缩" class="headerlink" title="html压缩"></a>html压缩</h2><ol>
<li>修改配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;,</span><br><span class="line">      &#x2F;&#x2F; 压缩html代码</span><br><span class="line">      minify: &#123;</span><br><span class="line">        &#x2F;&#x2F; 移除空格</span><br><span class="line">        collapseWhitespace: true,</span><br><span class="line">        &#x2F;&#x2F; 移除注释</span><br><span class="line">        removeComments: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;production&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="生产环境配置"><a href="#生产环境配置" class="headerlink" title="生产环境配置"></a>生产环境配置</h2><ol>
<li>修改配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const MiniCssExtractPlugin &#x3D; require(&#39;mini-css-extract-plugin&#39;);</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin &#x3D; require(&#39;optimize-css-assets-webpack-plugin&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 定义nodejs环境变量：决定使用browserslist的哪个环境</span><br><span class="line">process.env.NODE_ENV &#x3D; &#39;production&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 复用loader</span><br><span class="line">const commonCssLoader &#x3D; [</span><br><span class="line">  MiniCssExtractPlugin.loader,</span><br><span class="line">  &#39;css-loader&#39;,</span><br><span class="line">  &#123;</span><br><span class="line">    &#x2F;&#x2F; 还需要在package.json中定义browserslist</span><br><span class="line">    loader: &#39;postcss-loader&#39;,</span><br><span class="line">    options: &#123;</span><br><span class="line">      ident: &#39;postcss&#39;,</span><br><span class="line">      plugins: () &#x3D;&gt; [require(&#39;postcss-preset-env&#39;)()]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.css$&#x2F;,</span><br><span class="line">        use: [...commonCssLoader]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.less$&#x2F;,</span><br><span class="line">        use: [...commonCssLoader, &#39;less-loader&#39;]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#x2F;*</span><br><span class="line">        正常来讲，一个文件只能被一个loader处理。</span><br><span class="line">        当一个文件要被多个loader处理，那么一定要指定loader执行的先后顺序：</span><br><span class="line">          先执行eslint 在执行babel</span><br><span class="line">      *&#x2F;</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 在package.json中eslintConfig --&gt; airbnb</span><br><span class="line">        test: &#x2F;\.js$&#x2F;,</span><br><span class="line">        exclude: &#x2F;node_modules&#x2F;,</span><br><span class="line">        &#x2F;&#x2F; 优先执行</span><br><span class="line">        enforce: &#39;pre&#39;,</span><br><span class="line">        loader: &#39;eslint-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          fix: true</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.js$&#x2F;,</span><br><span class="line">        exclude: &#x2F;node_modules&#x2F;,</span><br><span class="line">        loader: &#39;babel-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          presets: [</span><br><span class="line">            [</span><br><span class="line">              &#39;@babel&#x2F;preset-env&#39;,</span><br><span class="line">              &#123;</span><br><span class="line">                useBuiltIns: &#39;usage&#39;,</span><br><span class="line">                corejs: &#123;version: 3&#125;,</span><br><span class="line">                targets: &#123;</span><br><span class="line">                  chrome: &#39;60&#39;,</span><br><span class="line">                  firefox: &#39;50&#39;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.(jpg|png|gif)&#x2F;,</span><br><span class="line">        loader: &#39;url-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: 8 * 1024,</span><br><span class="line">          name: &#39;[hash:10].[ext]&#39;,</span><br><span class="line">          outputPath: &#39;imgs&#39;,</span><br><span class="line">          esModule: false</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.html$&#x2F;,</span><br><span class="line">        loader: &#39;html-loader&#39;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        exclude: &#x2F;\.(js|css|less|html|jpg|png|gif)&#x2F;,</span><br><span class="line">        loader: &#39;file-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          outputPath: &#39;media&#39;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: &#39;css&#x2F;built.css&#39;</span><br><span class="line">    &#125;),</span><br><span class="line">    new OptimizeCssAssetsWebpackPlugin(),</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;,</span><br><span class="line">      minify: &#123;</span><br><span class="line">          &#x2F;&#x2F;移除空格和注释</span><br><span class="line">        collapseWhitespace: true,</span><br><span class="line">        removeComments: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;production&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h1 id="webpack优化环境配置"><a href="#webpack优化环境配置" class="headerlink" title="webpack优化环境配置"></a>webpack优化环境配置</h1><ol>
<li><p>开发环境性能优化</p>
<ul>
<li>优化打包构建速度<ul>
<li>HMR</li>
</ul>
</li>
<li>优化代码调试<ul>
<li>source-map</li>
</ul>
</li>
</ul>
</li>
<li><p>生产环境性能优化</p>
<ul>
<li>优化打包构建速度<ul>
<li>oneOf</li>
<li>babel缓存</li>
<li>多进程打包</li>
<li>externals</li>
<li>dll</li>
</ul>
</li>
<li>优化代码运行的性能<ul>
<li>缓存(hash-chunkhash-contenthash)</li>
<li>tree shaking</li>
<li>code split</li>
<li>懒加载/预加载</li>
<li>pwa</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="HMR"><a href="#HMR" class="headerlink" title="HMR"></a>HMR</h2><ul>
<li><p>HMR: hot module replacement 热模块替换 / 模块热替换</p>
<ul>
<li>作用：一个模块发生变化，只会重新打包这一个模块（而不是打包所有模块） 极大提升构建速度</li>
</ul>
</li>
<li><p>css文件：可以使用HMR功能：因为style-loader内部实现了~</p>
</li>
<li><p>js文件：默认不能使用HMR功能 –&gt; 需要修改js代码，添加支持HMR功能的代码</p>
<ul>
<li>注意：HMR功能对js的处理，只能处理非入口js文件的其他文件</li>
</ul>
</li>
<li><p>html文件: 默认不能使用HMR功能.同时会导致问题：html文件不能热更新了（不用做HMR功能）</p>
<ul>
<li>解决：修改entry入口，将html文件引入</li>
</ul>
</li>
</ul>
<ol>
<li>修改配置文件 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: [&#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;, &#39;.&#x2F;src&#x2F;index.html&#39;],</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#x2F;&#x2F; loader的配置</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 处理less资源</span><br><span class="line">        test: &#x2F;\.less$&#x2F;,</span><br><span class="line">        use: [&#39;style-loader&#39;, &#39;css-loader&#39;, &#39;less-loader&#39;]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 处理css资源</span><br><span class="line">        test: &#x2F;\.css$&#x2F;,</span><br><span class="line">        use: [&#39;style-loader&#39;, &#39;css-loader&#39;]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 处理图片资源</span><br><span class="line">        test: &#x2F;\.(jpg|png|gif)$&#x2F;,</span><br><span class="line">        loader: &#39;url-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: 8 * 1024,</span><br><span class="line">          name: &#39;[hash:10].[ext]&#39;,</span><br><span class="line">          &#x2F;&#x2F; 关闭es6模块化</span><br><span class="line">          esModule: false,</span><br><span class="line">          outputPath: &#39;imgs&#39;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 处理html中img资源</span><br><span class="line">        test: &#x2F;\.html$&#x2F;,</span><br><span class="line">        loader: &#39;html-loader&#39;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 处理其他资源</span><br><span class="line">        exclude: &#x2F;\.(html|js|css|less|jpg|png|gif)&#x2F;,</span><br><span class="line">        loader: &#39;file-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          name: &#39;[hash:10].[ext]&#39;,</span><br><span class="line">          outputPath: &#39;media&#39;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    &#x2F;&#x2F; plugins的配置</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;development&#39;,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: resolve(__dirname, &#39;build&#39;),</span><br><span class="line">    compress: true,</span><br><span class="line">    port: 3000,</span><br><span class="line">    open: true,</span><br><span class="line">    &#x2F;&#x2F; 开启HMR功能</span><br><span class="line">    &#x2F;&#x2F; 当修改了webpack配置，新配置要想生效，必须重新webpack服务</span><br><span class="line">    hot: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>js文件处理<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if (module.hot) &#123;</span><br><span class="line">  &#x2F;&#x2F; 一旦 module.hot 为true，说明开启了HMR功能。 --&gt; 让HMR功能代码生效</span><br><span class="line">  module.hot.accept(&#39;.&#x2F;print.js&#39;, function() &#123;</span><br><span class="line">    &#x2F;&#x2F; 方法会监听 print.js 文件的变化，一旦发生变化，其他模块不会重新打包构建。</span><br><span class="line">    &#x2F;&#x2F; 会执行后面的回调函数</span><br><span class="line">    print();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="source-map"><a href="#source-map" class="headerlink" title="source-map"></a>source-map</h2><ul>
<li><p>source-map: 一种 提供源代码到构建后代码映射 技术 （如果构建后代码出错了，通过映射可以追踪源代码错误）</p>
</li>
<li><p>内联 和 外部的区别：</p>
<ol>
<li>外部生成了文件，内联没有 </li>
<li>内联构建速度更快</li>
</ol>
</li>
<li><p>inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map</p>
<ul>
<li>source-map：外部<ul>
<li>错误代码准确信息 和 源代码的错误位置</li>
</ul>
</li>
<li>inline-source-map：内联<ul>
<li>只生成一个内联source-map</li>
<li>错误代码准确信息 和 源代码的错误位置</li>
</ul>
</li>
<li>hidden-source-map：外部<ul>
<li>错误代码错误原因，但是没有错误位置</li>
<li>不能追踪源代码错误，只能提示到构建后代码的错误位置</li>
</ul>
</li>
<li>eval-source-map：内联<ul>
<li>每一个文件都生成对应的source-map，都在eval</li>
<li>错误代码准确信息 和 源代码的错误位置</li>
</ul>
</li>
<li>nosources-source-map：外部<ul>
<li>错误代码准确信息, 但是没有任何源代码信息</li>
</ul>
</li>
<li>cheap-source-map：外部<ul>
<li>错误代码准确信息 和 源代码的错误位置 </li>
<li>只能精确到行</li>
</ul>
</li>
<li>cheap-module-source-map：外部<ul>
<li>错误代码准确信息 和 源代码的错误位置 </li>
<li>module会将loader的source map加入</li>
</ul>
</li>
</ul>
</li>
<li><p>开发环境：速度快，调试更友好</p>
<ul>
<li>速度快(eval&gt;inline&gt;cheap&gt;…)<ul>
<li>eval-cheap-souce-map</li>
<li>eval-source-map</li>
</ul>
</li>
<li>调试更友好  <ul>
<li>souce-map</li>
<li>cheap-module-souce-map</li>
<li>cheap-souce-map</li>
</ul>
</li>
<li>平衡性好<ul>
<li>eval-source-map  / eval-cheap-module-souce-map</li>
</ul>
</li>
</ul>
</li>
<li><p>生产环境：源代码要不要隐藏? 调试要不要更友好</p>
<ul>
<li>内联会让代码体积变大，所以在生产环境不用内联</li>
<li>nosources-source-map 全部隐藏</li>
<li>hidden-source-map 只隐藏源代码，会提示构建后代码错误信息</li>
<li>平衡性<ul>
<li>source-map / cheap-module-souce-map</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: [&#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;, &#39;.&#x2F;src&#x2F;index.html&#39;],</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#x2F;&#x2F; loader的配置</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    &#x2F;&#x2F; plugins的配置</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;development&#39;,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: resolve(__dirname, &#39;build&#39;),</span><br><span class="line">    compress: true,</span><br><span class="line">    port: 3000,</span><br><span class="line">    open: true,</span><br><span class="line">    hot: true</span><br><span class="line">  &#125;,</span><br><span class="line">  &#x2F;&#x2F; source -map 配置</span><br><span class="line">  devtool: &#39;eval-source-map&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h2 id="oneof"><a href="#oneof" class="headerlink" title="oneof"></a>oneof</h2><ul>
<li>提升构建速度，把所有的loader都放进oneof里就不会加载多次loader了</li>
</ul>
<ol>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const MiniCssExtractPlugin &#x3D; require(&#39;mini-css-extract-plugin&#39;);</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin &#x3D; require(&#39;optimize-css-assets-webpack-plugin&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 定义nodejs环境变量：决定使用browserslist的哪个环境</span><br><span class="line">process.env.NODE_ENV &#x3D; &#39;production&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 复用loader</span><br><span class="line">const commonCssLoader &#x3D; [</span><br><span class="line">  MiniCssExtractPlugin.loader,</span><br><span class="line">  &#39;css-loader&#39;,</span><br><span class="line">  &#123;</span><br><span class="line">    &#x2F;&#x2F; 还需要在package.json中定义browserslist</span><br><span class="line">    loader: &#39;postcss-loader&#39;,</span><br><span class="line">    options: &#123;</span><br><span class="line">      ident: &#39;postcss&#39;,</span><br><span class="line">      plugins: () &#x3D;&gt; [require(&#39;postcss-preset-env&#39;)()]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 在package.json中eslintConfig --&gt; airbnb</span><br><span class="line">        test: &#x2F;\.js$&#x2F;,</span><br><span class="line">        exclude: &#x2F;node_modules&#x2F;,</span><br><span class="line">        &#x2F;&#x2F; 优先执行</span><br><span class="line">        enforce: &#39;pre&#39;,</span><br><span class="line">        loader: &#39;eslint-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          fix: true</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 以下loader只会匹配一个</span><br><span class="line">        &#x2F;&#x2F; 注意：不能有两个配置处理同一种类型文件,所以在js语法检查和兼容性问题时，需要将其中一个loader拿到oneof外面</span><br><span class="line">        oneOf: [</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.css$&#x2F;,</span><br><span class="line">            use: [...commonCssLoader]</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.less$&#x2F;,</span><br><span class="line">            use: [...commonCssLoader, &#39;less-loader&#39;]</span><br><span class="line">          &#125;,</span><br><span class="line">          &#x2F;*</span><br><span class="line">            正常来讲，一个文件只能被一个loader处理。</span><br><span class="line">            当一个文件要被多个loader处理，那么一定要指定loader执行的先后顺序：</span><br><span class="line">              先执行eslint 在执行babel</span><br><span class="line">          *&#x2F;</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.js$&#x2F;,</span><br><span class="line">            exclude: &#x2F;node_modules&#x2F;,</span><br><span class="line">            loader: &#39;babel-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              presets: [</span><br><span class="line">                [</span><br><span class="line">                  &#39;@babel&#x2F;preset-env&#39;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    useBuiltIns: &#39;usage&#39;,</span><br><span class="line">                    corejs: &#123;version: 3&#125;,</span><br><span class="line">                    targets: &#123;</span><br><span class="line">                      chrome: &#39;60&#39;,</span><br><span class="line">                      firefox: &#39;50&#39;</span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                ]</span><br><span class="line">              ]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.(jpg|png|gif)&#x2F;,</span><br><span class="line">            loader: &#39;url-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              limit: 8 * 1024,</span><br><span class="line">              name: &#39;[hash:10].[ext]&#39;,</span><br><span class="line">              outputPath: &#39;imgs&#39;,</span><br><span class="line">              esModule: false</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.html$&#x2F;,</span><br><span class="line">            loader: &#39;html-loader&#39;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            exclude: &#x2F;\.(js|css|less|html|jpg|png|gif)&#x2F;,</span><br><span class="line">            loader: &#39;file-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              outputPath: &#39;media&#39;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: &#39;css&#x2F;built.css&#39;</span><br><span class="line">    &#125;),</span><br><span class="line">    new OptimizeCssAssetsWebpackPlugin(),</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        collapseWhitespace: true,</span><br><span class="line">        removeComments: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;production&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h2></li>
</ol>
<ul>
<li>babel缓存<ul>
<li>cacheDirectory: true</li>
<li>–&gt; 让第二次打包构建速度更快</li>
</ul>
</li>
<li>文件资源缓存<ul>
<li>hash: 每次wepack构建时会生成一个唯一的hash值。<ul>
<li>问题: 因为js和css同时使用一个hash值。<ul>
<li>如果重新打包，会导致所有缓存失效。（可能我却只改动一个文件）</li>
</ul>
</li>
</ul>
</li>
<li>chunkhash：根据chunk生成的hash值。如果打包来源于同一个chunk，那么hash值就一样<ul>
<li>问题: js和css的hash值还是一样的<ul>
<li>因为css是在js中被引入的，所以同属于一个chunk</li>
</ul>
</li>
</ul>
</li>
<li>contenthash: 根据文件的内容生成hash值。不同文件hash值一定不一样    </li>
<li>–&gt; 让代码上线运行缓存更好使用</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const MiniCssExtractPlugin &#x3D; require(&#39;mini-css-extract-plugin&#39;);</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin &#x3D; require(&#39;optimize-css-assets-webpack-plugin&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 定义nodejs环境变量：决定使用browserslist的哪个环境</span><br><span class="line">process.env.NODE_ENV &#x3D; &#39;production&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 复用loader</span><br><span class="line">const commonCssLoader &#x3D; [</span><br><span class="line">  MiniCssExtractPlugin.loader,</span><br><span class="line">  &#39;css-loader&#39;,</span><br><span class="line">  &#123;</span><br><span class="line">    &#x2F;&#x2F; 还需要在package.json中定义browserslist</span><br><span class="line">    loader: &#39;postcss-loader&#39;,</span><br><span class="line">    options: &#123;</span><br><span class="line">      ident: &#39;postcss&#39;,</span><br><span class="line">      plugins: () &#x3D;&gt; [require(&#39;postcss-preset-env&#39;)()]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.[contenthash:10].js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 在package.json中eslintConfig --&gt; airbnb</span><br><span class="line">        test: &#x2F;\.js$&#x2F;,</span><br><span class="line">        exclude: &#x2F;node_modules&#x2F;,</span><br><span class="line">        &#x2F;&#x2F; 优先执行</span><br><span class="line">        enforce: &#39;pre&#39;,</span><br><span class="line">        loader: &#39;eslint-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          fix: true</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line"></span><br><span class="line">        oneOf: [</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.css$&#x2F;,</span><br><span class="line">            use: [...commonCssLoader]</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.less$&#x2F;,</span><br><span class="line">            use: [...commonCssLoader, &#39;less-loader&#39;]</span><br><span class="line">          &#125;,</span><br><span class="line"></span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.js$&#x2F;,</span><br><span class="line">            exclude: &#x2F;node_modules&#x2F;,</span><br><span class="line">            loader: &#39;babel-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              presets: [</span><br><span class="line">                [</span><br><span class="line">                  &#39;@babel&#x2F;preset-env&#39;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    useBuiltIns: &#39;usage&#39;,</span><br><span class="line">                    corejs: &#123; version: 3 &#125;,</span><br><span class="line">                    targets: &#123;</span><br><span class="line">                      chrome: &#39;60&#39;,</span><br><span class="line">                      firefox: &#39;50&#39;</span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                ]</span><br><span class="line">              ],</span><br><span class="line">              &#x2F;&#x2F; 开启babel缓存</span><br><span class="line">              &#x2F;&#x2F; 第二次构建时，会读取之前的缓存</span><br><span class="line">              cacheDirectory: true</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.(jpg|png|gif)&#x2F;,</span><br><span class="line">            loader: &#39;url-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              limit: 8 * 1024,</span><br><span class="line">              name: &#39;[hash:10].[ext]&#39;,</span><br><span class="line">              outputPath: &#39;imgs&#39;,</span><br><span class="line">              esModule: false</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.html$&#x2F;,</span><br><span class="line">            loader: &#39;html-loader&#39;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            exclude: &#x2F;\.(js|css|less|html|jpg|png|gif)&#x2F;,</span><br><span class="line">            loader: &#39;file-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              outputPath: &#39;media&#39;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: &#39;css&#x2F;built.[contenthash:10].css&#39;</span><br><span class="line">    &#125;),</span><br><span class="line">    new OptimizeCssAssetsWebpackPlugin(),</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        collapseWhitespace: true,</span><br><span class="line">        removeComments: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;production&#39;,</span><br><span class="line">  devtool: &#39;source-map&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="tree-shaking"><a href="#tree-shaking" class="headerlink" title="tree shaking"></a>tree shaking</h2><ul>
<li><p>tree shaking：去除无用代码</p>
<ul>
<li>前提：<ol>
<li>必须使用ES6模块化  </li>
<li>开启production环境</li>
</ol>
</li>
<li>作用: 减少代码体积</li>
</ul>
</li>
<li><p>在package.json中配置 </p>
<ul>
<li>“sideEffects”: false 所有代码都没有副作用（都可以进行tree shaking）</li>
<li>问题：可能会把css / @babel/polyfill （副作用）文件干掉<br>“sideEffects”: [“<em>.css”, “</em>.less”]</li>
</ul>
</li>
</ul>
<ol>
<li>配置package.json文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;sideEffects&quot;: [</span><br><span class="line">  &quot;*.css&quot;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="code-split"><a href="#code-split" class="headerlink" title="code split"></a>code split</h2><ul>
<li>将一个大的js文件分割成几个小文件，这样就可以实现按需加载</li>
</ul>
<ol>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  &#x2F;&#x2F; 单入口</span><br><span class="line">  &#x2F;&#x2F; entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    index: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">    test: &#39;.&#x2F;src&#x2F;js&#x2F;test.js&#39;</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    &#x2F;&#x2F; [name]：取文件名</span><br><span class="line">    filename: &#39;js&#x2F;[name].[contenthash:10].js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        collapseWhitespace: true,</span><br><span class="line">        removeComments: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  &#x2F;*</span><br><span class="line">    1. 可以将node_modules中代码单独打包一个chunk最终输出</span><br><span class="line">    2. 自动分析多入口chunk中，有没有公共的文件。如果有会打包成单独一个chunk</span><br><span class="line">  *&#x2F;</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      chunks: &#39;all&#39;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mode: &#39;production&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="懒加载和预加载"><a href="#懒加载和预加载" class="headerlink" title="懒加载和预加载"></a>懒加载和预加载</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&#39;btn&#39;).onclick &#x3D; function() &#123;</span><br><span class="line">  &#x2F;&#x2F; 懒加载：当文件需要使用时才加载</span><br><span class="line">  &#x2F;&#x2F; 预加载 prefetch：会在使用之前，提前加载js文件 </span><br><span class="line">  &#x2F;&#x2F; 正常加载可以认为是并行加载（同一时间加载多个文件）  </span><br><span class="line">  &#x2F;&#x2F; 预加载 prefetch：等其他资源加载完毕，浏览器空闲了，再偷偷加载资源</span><br><span class="line">  import(&#x2F;* webpackChunkName: &#39;test&#39;, webpackPrefetch: true *&#x2F;&#39;.&#x2F;test&#39;).then((&#123; mul &#125;) &#x3D;&gt; &#123;</span><br><span class="line">    console.log(mul(4, 5));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="pwa"><a href="#pwa" class="headerlink" title="pwa"></a>pwa</h2><ul>
<li>渐进式网络开发应用程序(离线可访问)<ul>
<li>workbox –&gt; workbox-webpack-plugin</li>
</ul>
</li>
</ul>
<ol>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const MiniCssExtractPlugin &#x3D; require(&#39;mini-css-extract-plugin&#39;);</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin &#x3D; require(&#39;optimize-css-assets-webpack-plugin&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line">const WorkboxWebpackPlugin &#x3D; require(&#39;workbox-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 定义nodejs环境变量：决定使用browserslist的哪个环境</span><br><span class="line">process.env.NODE_ENV &#x3D; &#39;production&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.[contenthash:10].js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      </span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: &#39;css&#x2F;built.[contenthash:10].css&#39;</span><br><span class="line">    &#125;),</span><br><span class="line">    new OptimizeCssAssetsWebpackPlugin(),</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        collapseWhitespace: true,</span><br><span class="line">        removeComments: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    </span><br><span class="line">    new WorkboxWebpackPlugin.GenerateSW(&#123;</span><br><span class="line">      &#x2F;*</span><br><span class="line">        1. 帮助serviceworker快速启动</span><br><span class="line">        2. 删除旧的 serviceworker</span><br><span class="line"></span><br><span class="line">        生成一个 serviceworker 配置文件~</span><br><span class="line">      *&#x2F;</span><br><span class="line">      clientsClaim: true,</span><br><span class="line">      skipWaiting: true</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;production&#39;,</span><br><span class="line">  devtool: &#39;source-map&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>修改入口js文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">*&#x2F;</span><br><span class="line">  1. eslint不认识 window、navigator全局变量</span><br><span class="line">    解决：需要修改package.json中eslintConfig配置</span><br><span class="line">      &quot;env&quot;: &#123;</span><br><span class="line">        &quot;browser&quot;: true &#x2F;&#x2F; 支持浏览器端全局变量</span><br><span class="line">      &#125;</span><br><span class="line">   2. sw代码必须运行在服务器上</span><br><span class="line">      --&gt; nodejs</span><br><span class="line">      --&gt;</span><br><span class="line">        npm i serve -g</span><br><span class="line">        serve -s build 启动服务器，将build目录下所有资源作为静态资源暴露出去</span><br><span class="line">*&#x2F;</span><br><span class="line">&#x2F;&#x2F; 注册serviceWorker</span><br><span class="line">&#x2F;&#x2F; 处理兼容性问题</span><br><span class="line">if (&#39;serviceWorker&#39; in navigator) &#123;</span><br><span class="line">  window.addEventListener(&#39;load&#39;, () &#x3D;&gt; &#123;</span><br><span class="line">    navigator.serviceWorker</span><br><span class="line">      .register(&#39;&#x2F;service-worker.js&#39;)</span><br><span class="line">      .then(() &#x3D;&gt; &#123;</span><br><span class="line">        console.log(&#39;sw注册成功了~&#39;);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(() &#x3D;&gt; &#123;</span><br><span class="line">        console.log(&#39;sw注册失败了~&#39;);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="多进程打包"><a href="#多进程打包" class="headerlink" title="多进程打包"></a>多进程打包</h2><ul>
<li>thread-loader</li>
</ul>
<ol>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const MiniCssExtractPlugin &#x3D; require(&#39;mini-css-extract-plugin&#39;);</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin &#x3D; require(&#39;optimize-css-assets-webpack-plugin&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line">const WorkboxWebpackPlugin &#x3D; require(&#39;workbox-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 定义nodejs环境变量：决定使用browserslist的哪个环境</span><br><span class="line">process.env.NODE_ENV &#x3D; &#39;production&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 复用loader</span><br><span class="line">const commonCssLoader &#x3D; [</span><br><span class="line">  MiniCssExtractPlugin.loader,</span><br><span class="line">  &#39;css-loader&#39;,</span><br><span class="line">  &#123;</span><br><span class="line">    &#x2F;&#x2F; 还需要在package.json中定义browserslist</span><br><span class="line">    loader: &#39;postcss-loader&#39;,</span><br><span class="line">    options: &#123;</span><br><span class="line">      ident: &#39;postcss&#39;,</span><br><span class="line">      plugins: () &#x3D;&gt; [require(&#39;postcss-preset-env&#39;)()]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.[contenthash:10].js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 在package.json中eslintConfig --&gt; airbnb</span><br><span class="line">        test: &#x2F;\.js$&#x2F;,</span><br><span class="line">        exclude: &#x2F;node_modules&#x2F;,</span><br><span class="line">        &#x2F;&#x2F; 优先执行</span><br><span class="line">        enforce: &#39;pre&#39;,</span><br><span class="line">        loader: &#39;eslint-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          fix: true</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 以下loader只会匹配一个</span><br><span class="line">        &#x2F;&#x2F; 注意：不能有两个配置处理同一种类型文件</span><br><span class="line">        oneOf: [</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.css$&#x2F;,</span><br><span class="line">            use: [...commonCssLoader]</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.less$&#x2F;,</span><br><span class="line">            use: [...commonCssLoader, &#39;less-loader&#39;]</span><br><span class="line">          &#125;,</span><br><span class="line">          &#x2F;*</span><br><span class="line">            正常来讲，一个文件只能被一个loader处理。</span><br><span class="line">            当一个文件要被多个loader处理，那么一定要指定loader执行的先后顺序：</span><br><span class="line">              先执行eslint 在执行babel</span><br><span class="line">          *&#x2F;</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.js$&#x2F;,</span><br><span class="line">            exclude: &#x2F;node_modules&#x2F;,</span><br><span class="line">            use: [</span><br><span class="line">              &#x2F;* </span><br><span class="line">                开启多进程打包。 </span><br><span class="line">                进程启动大概为600ms，进程通信也有开销。</span><br><span class="line">                只有工作消耗时间比较长，才需要多进程打包</span><br><span class="line">              *&#x2F;</span><br><span class="line">              &#123;</span><br><span class="line">                loader: &#39;thread-loader&#39;,</span><br><span class="line">                options: &#123;</span><br><span class="line">                  workers: 2 &#x2F;&#x2F; 进程2个</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                loader: &#39;babel-loader&#39;,</span><br><span class="line">                options: &#123;</span><br><span class="line">                  presets: [</span><br><span class="line">                    [</span><br><span class="line">                      &#39;@babel&#x2F;preset-env&#39;,</span><br><span class="line">                      &#123;</span><br><span class="line">                        useBuiltIns: &#39;usage&#39;,</span><br><span class="line">                        corejs: &#123; version: 3 &#125;,</span><br><span class="line">                        targets: &#123;</span><br><span class="line">                          chrome: &#39;60&#39;,</span><br><span class="line">                          firefox: &#39;50&#39;</span><br><span class="line">                        &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                    ]</span><br><span class="line">                  ],</span><br><span class="line">                  &#x2F;&#x2F; 开启babel缓存</span><br><span class="line">                  &#x2F;&#x2F; 第二次构建时，会读取之前的缓存</span><br><span class="line">                  cacheDirectory: true</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.(jpg|png|gif)&#x2F;,</span><br><span class="line">            loader: &#39;url-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              limit: 8 * 1024,</span><br><span class="line">              name: &#39;[hash:10].[ext]&#39;,</span><br><span class="line">              outputPath: &#39;imgs&#39;,</span><br><span class="line">              esModule: false</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: &#x2F;\.html$&#x2F;,</span><br><span class="line">            loader: &#39;html-loader&#39;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            exclude: &#x2F;\.(js|css|less|html|jpg|png|gif)&#x2F;,</span><br><span class="line">            loader: &#39;file-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              outputPath: &#39;media&#39;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: &#39;css&#x2F;built.[contenthash:10].css&#39;</span><br><span class="line">    &#125;),</span><br><span class="line">    new OptimizeCssAssetsWebpackPlugin(),</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        collapseWhitespace: true,</span><br><span class="line">        removeComments: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    new WorkboxWebpackPlugin.GenerateSW(&#123;</span><br><span class="line">      &#x2F;*</span><br><span class="line">        1. 帮助serviceworker快速启动</span><br><span class="line">        2. 删除旧的 serviceworker</span><br><span class="line"></span><br><span class="line">        生成一个 serviceworker 配置文件~</span><br><span class="line">      *&#x2F;</span><br><span class="line">      clientsClaim: true,</span><br><span class="line">      skipWaiting: true</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;production&#39;,</span><br><span class="line">  devtool: &#39;source-map&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="externals"><a href="#externals" class="headerlink" title="externals"></a>externals</h2><ul>
<li>防止将某些包打包到最终输出的文件中</li>
</ul>
<ol>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;production&#39;,</span><br><span class="line">  externals: &#123;</span><br><span class="line">    &#x2F;&#x2F; 拒绝jQuery被打包进来</span><br><span class="line">    jquery: &#39;jQuery&#39;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="dll"><a href="#dll" class="headerlink" title="dll"></a>dll</h2><ul>
<li>动态链接库，类似于externals，不同的是dll会将多个库单独的打包，将多个库打包成一个chunk</li>
</ul>
<ol>
<li>配置dll.js<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">  使用dll技术，对某些库（第三方库：jquery、react、vue...）进行单独打包</span><br><span class="line">    当你运行 webpack 时，默认查找 webpack.config.js 配置文件</span><br><span class="line">    需求：需要运行 webpack.dll.js 文件</span><br><span class="line">      --&gt; webpack --config webpack.dll.js</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const webpack &#x3D; require(&#39;webpack&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    &#x2F;&#x2F; 最终打包生成的[name] --&gt; jquery</span><br><span class="line">    &#x2F;&#x2F; [&#39;jquery&#39;] --&gt; 要打包的库是jquery</span><br><span class="line">    jquery: [&#39;jquery&#39;],</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;[name].js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;dll&#39;),</span><br><span class="line">    library: &#39;[name]_[hash]&#39; &#x2F;&#x2F; 打包的库里面向外暴露出去的内容叫什么名字</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    &#x2F;&#x2F; 打包生成一个 manifest.json --&gt; 提供和jquery映射</span><br><span class="line">    new webpack.DllPlugin(&#123;</span><br><span class="line">      name: &#39;[name]_[hash]&#39;, &#x2F;&#x2F; 映射库的暴露的内容名称</span><br><span class="line">      path: resolve(__dirname, &#39;dll&#x2F;manifest.json&#39;) &#x2F;&#x2F; 输出文件路径</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;production&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


</li>
</ol>
<ol start="2">
<li>配置config文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line">const webpack &#x3D; require(&#39;webpack&#39;);</span><br><span class="line">const AddAssetHtmlWebpackPlugin &#x3D; require(&#39;add-asset-html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;built.js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &#39;.&#x2F;src&#x2F;index.html&#39;</span><br><span class="line">    &#125;),</span><br><span class="line">    &#x2F;&#x2F; 告诉webpack哪些库不参与打包，同时使用时的名称也得变~</span><br><span class="line">    new webpack.DllReferencePlugin(&#123;</span><br><span class="line">      manifest: resolve(__dirname, &#39;dll&#x2F;manifest.json&#39;)</span><br><span class="line">    &#125;),</span><br><span class="line">    &#x2F;&#x2F; 将某个文件打包输出去，并在html中自动引入该资源</span><br><span class="line">    new AddAssetHtmlWebpackPlugin(&#123;</span><br><span class="line">      filepath: resolve(__dirname, &#39;dll&#x2F;jquery.js&#39;)</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &#39;production&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li>运行指令：webpack</li>
</ol>
<h1 id="webpack配置详解"><a href="#webpack配置详解" class="headerlink" title="webpack配置详解"></a>webpack配置详解</h1><h2 id="entry"><a href="#entry" class="headerlink" title="entry"></a>entry</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">  entry: 入口起点</span><br><span class="line">    1. string --&gt; &#39;.&#x2F;src&#x2F;index.js&#39;</span><br><span class="line">      单入口</span><br><span class="line">      打包形成一个chunk。 输出一个bundle文件。</span><br><span class="line">      此时chunk的名称默认是 main</span><br><span class="line">    2. array  --&gt; [&#39;.&#x2F;src&#x2F;index.js&#39;, &#39;.&#x2F;src&#x2F;add.js&#39;]</span><br><span class="line">      多入口</span><br><span class="line">      所有入口文件最终只会形成一个chunk, 输出出去只有一个bundle文件。</span><br><span class="line">        --&gt; 只有在HMR功能中让html热更新生效~</span><br><span class="line">    3. object</span><br><span class="line">      多入口</span><br><span class="line">      有几个入口文件就形成几个chunk，输出几个bundle文件</span><br><span class="line">      此时chunk的名称是 key</span><br><span class="line"></span><br><span class="line">      --&gt; 特殊用法</span><br><span class="line">        &#123;</span><br><span class="line">          &#x2F;&#x2F; 所有入口文件最终只会形成一个chunk, 输出出去只有一个bundle文件。</span><br><span class="line">          index: [&#39;.&#x2F;src&#x2F;index.js&#39;, &#39;.&#x2F;src&#x2F;count.js&#39;], </span><br><span class="line">          &#x2F;&#x2F; 形成一个chunk，输出一个bundle文件。</span><br><span class="line">          add: &#39;.&#x2F;src&#x2F;add.js&#39;</span><br><span class="line">        &#125;</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    index: [&#39;.&#x2F;src&#x2F;index.js&#39;, &#39;.&#x2F;src&#x2F;count.js&#39;], </span><br><span class="line">    add: &#39;.&#x2F;src&#x2F;add.js&#39;</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;[name].js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [new HtmlWebpackPlugin()],</span><br><span class="line">  mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="output"><a href="#output" class="headerlink" title="output"></a>output</h2><ol>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    &#x2F;&#x2F; 文件名称（指定名称+目录）</span><br><span class="line">    filename: &#39;js&#x2F;[name].js&#39;,</span><br><span class="line">    &#x2F;&#x2F; 输出文件目录（将来所有资源输出的公共目录）</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;),</span><br><span class="line">    &#x2F;&#x2F; 所有资源引入公共路径前缀 --&gt; &#39;imgs&#x2F;a.jpg&#39; --&gt; &#39;&#x2F;imgs&#x2F;a.jpg&#39;</span><br><span class="line">    publicPath: &#39;&#x2F;&#39;,</span><br><span class="line">    chunkFilename: &#39;js&#x2F;[name]_chunk.js&#39;, &#x2F;&#x2F; 非入口chunk的名称</span><br><span class="line">    &#x2F;&#x2F; library: &#39;[name]&#39;, &#x2F;&#x2F; 整个库向外暴露的变量名</span><br><span class="line">    &#x2F;&#x2F; libraryTarget: &#39;window&#39; &#x2F;&#x2F; 变量名添加到哪个属性上 browser</span><br><span class="line">    &#x2F;&#x2F; libraryTarget: &#39;global&#39; &#x2F;&#x2F; 变量名添加到哪个属性上 node</span><br><span class="line">    &#x2F;&#x2F; libraryTarget: &#39;commonjs&#39;</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [new HtmlWebpackPlugin()],</span><br><span class="line">  mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="module"><a href="#module" class="headerlink" title="module"></a>module</h2><ol>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;[name].js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#x2F;&#x2F; loader的配置</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.css$&#x2F;,</span><br><span class="line">        &#x2F;&#x2F; 多个loader用use</span><br><span class="line">        use: [&#39;style-loader&#39;, &#39;css-loader&#39;]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.js$&#x2F;,</span><br><span class="line">        &#x2F;&#x2F; 排除node_modules下的js文件</span><br><span class="line">        exclude: &#x2F;node_modules&#x2F;,</span><br><span class="line">        &#x2F;&#x2F; 只检查 src 下的js文件</span><br><span class="line">        include: resolve(__dirname, &#39;src&#39;),</span><br><span class="line">        &#x2F;&#x2F; 优先执行</span><br><span class="line">        enforce: &#39;pre&#39;,</span><br><span class="line">        &#x2F;&#x2F; 延后执行</span><br><span class="line">        &#x2F;&#x2F; enforce: &#39;post&#39;,</span><br><span class="line">        &#x2F;&#x2F; 单个loader用loader</span><br><span class="line">        loader: &#39;eslint-loader&#39;,</span><br><span class="line">        options: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 以下配置只会生效一个</span><br><span class="line">        oneOf: []</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [new HtmlWebpackPlugin()],</span><br><span class="line">  mode: &#39;development&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="resolve"><a href="#resolve" class="headerlink" title="resolve"></a>resolve</h2><ol>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">const &#123; resolve &#125; &#x3D; require(&#39;path&#39;);</span><br><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  entry: &#39;.&#x2F;src&#x2F;js&#x2F;index.js&#39;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#39;js&#x2F;[name].js&#39;,</span><br><span class="line">    path: resolve(__dirname, &#39;build&#39;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: &#x2F;\.css$&#x2F;,</span><br><span class="line">        use: [&#39;style-loader&#39;, &#39;css-loader&#39;]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [new HtmlWebpackPlugin()],</span><br><span class="line">  mode: &#39;development&#39;,</span><br><span class="line">  &#x2F;&#x2F; 解析模块的规则</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    &#x2F;&#x2F; 配置解析模块路径别名: 优点简写路径 缺点路径没有提示</span><br><span class="line">    alias: &#123;</span><br><span class="line">      $css: resolve(__dirname, &#39;src&#x2F;css&#39;)</span><br><span class="line">    &#125;,</span><br><span class="line">    &#x2F;&#x2F; 配置省略文件路径的后缀名</span><br><span class="line">    extensions: [&#39;.js&#39;, &#39;.json&#39;, &#39;.jsx&#39;, &#39;.css&#39;],</span><br><span class="line">    &#x2F;&#x2F; 告诉 webpack 解析模块是去找哪个目录</span><br><span class="line">    modules: [resolve(__dirname, &#39;..&#x2F;..&#x2F;node_modules&#39;), &#39;node_modules&#39;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="dev-server"><a href="#dev-server" class="headerlink" title="dev server"></a>dev server</h2></li>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">  &#x2F;&#x2F; 运行代码的目录</span><br><span class="line">  contentBase: resolve(__dirname, &#39;build&#39;),</span><br><span class="line">  &#x2F;&#x2F; 监视 contentBase 目录下的所有文件，一旦文件变化就会 reload</span><br><span class="line">  watchContentBase: true,</span><br><span class="line">  watchOptions: &#123;</span><br><span class="line">    &#x2F;&#x2F; 忽略文件</span><br><span class="line">    ignored: &#x2F;node_modules&#x2F;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#x2F;&#x2F; 启动gzip压缩</span><br><span class="line">  compress: true,</span><br><span class="line">  &#x2F;&#x2F; 端口号</span><br><span class="line">  port: 5000,</span><br><span class="line">  &#x2F;&#x2F; 域名</span><br><span class="line">  host: &#39;localhost&#39;,</span><br><span class="line">  &#x2F;&#x2F; 自动打开浏览器</span><br><span class="line">  open: true,</span><br><span class="line">  &#x2F;&#x2F; 开启HMR功能</span><br><span class="line">  hot: true,</span><br><span class="line">  &#x2F;&#x2F; 不要显示启动服务器日志信息</span><br><span class="line">  clientLogLevel: &#39;none&#39;,</span><br><span class="line">  &#x2F;&#x2F; 除了一些基本启动信息以外，其他内容都不要显示</span><br><span class="line">  quiet: true,</span><br><span class="line">  &#x2F;&#x2F; 如果出错了，不要全屏提示~</span><br><span class="line">  overlay: false,</span><br><span class="line">  &#x2F;&#x2F; 服务器代理 --&gt; 解决开发环境跨域问题</span><br><span class="line">  proxy: &#123;</span><br><span class="line">    &#x2F;&#x2F; 一旦devServer(5000)服务器接受到 &#x2F;api&#x2F;xxx 的请求，就会把请求转发到另外一个服务器(3000)</span><br><span class="line">    &#39;&#x2F;api&#39;: &#123;</span><br><span class="line">      target: &#39;http:&#x2F;&#x2F;localhost:3000&#39;,</span><br><span class="line">      &#x2F;&#x2F; 发送请求时，请求路径重写：将 &#x2F;api&#x2F;xxx --&gt; &#x2F;xxx （去掉&#x2F;api）</span><br><span class="line">      pathRewrite: &#123;</span><br><span class="line">        &#39;^&#x2F;api&#39;: &#39;&#39;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="optimization"><a href="#optimization" class="headerlink" title="optimization"></a>optimization</h2><ol>
<li>配置文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   splitChunks: &#123;</span><br><span class="line">     chunks: &#39;all&#39;</span><br><span class="line">     &#x2F;&#x2F; 默认值，可以不写~</span><br><span class="line">     &#x2F;* minSize: 30 * 1024, &#x2F;&#x2F; 分割的chunk最小为30kb</span><br><span class="line">     maxSiza: 0, &#x2F;&#x2F; 最大没有限制</span><br><span class="line">     minChunks: 1, &#x2F;&#x2F; 要提取的chunk最少被引用1次</span><br><span class="line">     maxAsyncRequests: 5, &#x2F;&#x2F; 按需加载时并行加载的文件的最大数量</span><br><span class="line">     maxInitialRequests: 3, &#x2F;&#x2F; 入口js文件最大并行请求数量</span><br><span class="line">     automaticNameDelimiter: &#39;~&#39;, &#x2F;&#x2F; 名称连接符</span><br><span class="line">     name: true, &#x2F;&#x2F; 可以使用命名规则</span><br><span class="line">     cacheGroups: &#123;</span><br><span class="line">       &#x2F;&#x2F; 分割chunk的组</span><br><span class="line">       &#x2F;&#x2F; node_modules文件会被打包到 vendors 组的chunk中。--&gt; vendors~xxx.js</span><br><span class="line">       &#x2F;&#x2F; 满足上面的公共规则，如：大小超过30kb，至少被引用一次。</span><br><span class="line">       vendors: &#123;</span><br><span class="line">         test: &#x2F;[\\&#x2F;]node_modules[\\&#x2F;]&#x2F;,</span><br><span class="line">         &#x2F;&#x2F; 优先级</span><br><span class="line">         priority: -10</span><br><span class="line">       &#125;,</span><br><span class="line">       default: &#123;</span><br><span class="line">         &#x2F;&#x2F; 要提取的chunk最少被引用2次</span><br><span class="line">         minChunks: 2,</span><br><span class="line">         &#x2F;&#x2F; 优先级</span><br><span class="line">         priority: -20,</span><br><span class="line">         &#x2F;&#x2F; 如果当前要打包的模块，和之前已经被提取的模块是同一个，就会复用，而不是重新打包模块</span><br><span class="line">         reuseExistingChunk: true</span><br><span class="line">       &#125; </span><br><span class="line">     &#125;*&#x2F;</span><br><span class="line">   &#125;,</span><br><span class="line">   &#x2F;&#x2F; 将当前模块的记录其他模块的hash单独打包为一个文件 runtime</span><br><span class="line">   &#x2F;&#x2F; 解决：修改a文件导致b文件的contenthash变化</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   runtimeChunk: &#123;</span><br><span class="line">     name: entrypoint &#x3D;&gt; &#96;runtime-$&#123;entrypoint.name&#125;&#96;</span><br><span class="line">   &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   minimizer: [</span><br><span class="line">     &#x2F;&#x2F; 配置生产环境的压缩方案：js和css</span><br><span class="line">     new TerserWebpackPlugin(&#123;</span><br><span class="line">       &#x2F;&#x2F; 开启缓存</span><br><span class="line">       cache: true,</span><br><span class="line">       &#x2F;&#x2F; 开启多进程打包</span><br><span class="line">       parallel: true,</span><br><span class="line">       &#x2F;&#x2F; 启动source-map</span><br><span class="line">       sourceMap: true</span><br><span class="line">     &#125;)</span><br><span class="line">   ]</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h1 id="webpack5（正在开发中-71-）"><a href="#webpack5（正在开发中-71-）" class="headerlink" title="webpack5（正在开发中 71%）"></a>webpack5（正在开发中 71%）</h1><p>此版本重点关注以下内容:</p>
<ul>
<li>通过持久缓存提高构建性能.</li>
<li>使用更好的算法和默认值来改善长期缓存.</li>
<li>通过更好的树摇和代码生成来改善捆绑包大小.</li>
<li>清除处于怪异状态的内部结构，同时在 v4 中实现功能而不引入任何重大更改.</li>
<li>通过引入重大更改来为将来的功能做准备，以使我们能够尽可能长时间地使用 v5.</li>
</ul>
<h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><ul>
<li>npm i webpack@next webpack-cli -D</li>
</ul>
<h2 id="自动删除-Node-js-Polyfills"><a href="#自动删除-Node-js-Polyfills" class="headerlink" title="自动删除 Node.js Polyfills"></a>自动删除 Node.js Polyfills</h2><ul>
<li><p>早期，webpack 的目标是允许在浏览器中运行大多数 node.js 模块，但是模块格局发生了变化，许多模块用途现在主要是为前端目的而编写的。<br>webpack &lt;= 4 附带了许多 node.js 核心模块的 polyfill，一旦模块使用任何核心模块（即 crypto 模块），这些模块就会自动应用。</p>
</li>
<li><p>尽管这使使用为 node.js 编写的模块变得容易，但它会将这些巨大的 polyfill 添加到包中。在许多情况下，这些 polyfill 是不必要的。</p>
</li>
<li><p>webpack 5 会自动停止填充这些核心模块，并专注于与前端兼容的模块。</p>
</li>
</ul>
<p>迁移：</p>
<ul>
<li>尽可能尝试使用与前端兼容的模块。</li>
<li>可以为 node.js 核心模块手动添加一个 polyfill。错误消息将提示如何实现该目标。</li>
</ul>
<h2 id="Chunk-和模块-ID"><a href="#Chunk-和模块-ID" class="headerlink" title="Chunk 和模块 ID"></a>Chunk 和模块 ID</h2><ul>
<li>添加了用于长期缓存的新算法。在生产模式下默认情况下启用这些功能。</li>
</ul>
<p><code>chunkIds: &quot;deterministic&quot;, moduleIds: &quot;deterministic&quot;</code></p>
<h2 id="Chunk-ID"><a href="#Chunk-ID" class="headerlink" title="Chunk ID"></a>Chunk ID</h2><ul>
<li><p>你可以不用使用 <code>import(/* webpackChunkName: &quot;name&quot; */ &quot;module&quot;)</code> 在开发环境来为 chunk 命名，生产环境还是有必要的</p>
</li>
<li><p>webpack 内部有 chunk 命名规则，不再是以 id(0, 1, 2)命名了</p>
</li>
</ul>
<h2 id="Tree-Shaking"><a href="#Tree-Shaking" class="headerlink" title="Tree Shaking"></a>Tree Shaking</h2><ol>
<li>webpack 现在能够处理对嵌套模块的 tree shaking</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// inner.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> b = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// module.js</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> inner <span class="keyword">from</span> <span class="string">'./inner'</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; inner &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// user.js</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="built_in">module</span> <span class="keyword">from</span> <span class="string">'./module'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">module</span>.inner.a);</span><br></pre></td></tr></table></figure>

<ul>
<li>在生产环境中, inner 模块暴露的 <code>b</code> 会被删除</li>
</ul>
<ol start="2">
<li>webpack 现在能够多个模块之前的关系</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; something &#125; <span class="keyword">from</span> <span class="string">'./something'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">usingSomething</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> something;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> usingSomething();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>当设置了<code>&quot;sideEffects&quot;: false</code>时，一旦发现<code>test</code>方法没有使用，不但删除<code>test</code>，还会删除<code>&quot;./something&quot;</code></li>
</ul>
<ol start="3">
<li>webpack 现在能处理对 Commonjs 的 tree shaking</li>
</ol>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><ul>
<li><p>webpack 4 默认只能输出 ES5 代码</p>
</li>
<li><p>webpack 5 开始新增一个属性 output.ecmaVersion, 可以生成 ES5 和 ES6 / ES2015 代码.</p>
</li>
<li><p>如：<code>output.ecmaVersion: 2015</code></p>
</li>
</ul>
<h2 id="SplitChunk"><a href="#SplitChunk" class="headerlink" title="SplitChunk"></a>SplitChunk</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack4</span></span><br><span class="line">minSize: <span class="number">30000</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack5</span></span><br><span class="line">minSize: &#123;</span><br><span class="line">  javascript: <span class="number">30000</span>,</span><br><span class="line">  style: <span class="number">50000</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Caching"><a href="#Caching" class="headerlink" title="Caching"></a>Caching</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置缓存</span></span><br><span class="line">cache: &#123;</span><br><span class="line">  <span class="comment">// 磁盘存储</span></span><br><span class="line">  type: <span class="string">"filesystem"</span>,</span><br><span class="line">  buildDependencies: &#123;</span><br><span class="line">    <span class="comment">// 当配置修改时，缓存失效</span></span><br><span class="line">    config: [__filename]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>-缓存将存储到 <code>node_modules/.cache/webpack</code></p>
<h2 id="监视输出文件"><a href="#监视输出文件" class="headerlink" title="监视输出文件"></a>监视输出文件</h2><ul>
<li><p>之前 webpack 总是在第一次构建时输出全部文件，但是监视重新构建时会只更新修改的文件。</p>
</li>
<li><p>此次更新在第一次构建时会找到输出文件看是否有变化，从而决定要不要输出全部文件。</p>
</li>
</ul>
<h2 id="默认值"><a href="#默认值" class="headerlink" title="默认值"></a>默认值</h2><ul>
<li><code>entry: &quot;./src/index.js</code></li>
<li><code>output.path: path.resolve(__dirname, &quot;dist&quot;)</code></li>
<li><code>output.filename: &quot;[name].js&quot;</code></li>
</ul>
<h2 id="更多内容"><a href="#更多内容" class="headerlink" title="更多内容"></a>更多内容</h2><p><a href="https://github.com/webpack/changelog-v5" target="_blank" rel="noopener">https://github.com/webpack/changelog-v5</a></p>
</div></article><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Webpack/">Webpack</a></div><div class="social-share pull-right" data-disabled="Linkedin,点点,Facebook,Twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/07/20/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%9F%E7%84%B6%E8%A2%AB%E6%8C%96%E7%9F%BF%E7%A8%8B%E5%BA%8F%E6%94%BB%E5%87%BB%EF%BC%81%EF%BC%9F/"><i class="fa fa-chevron-left">  </i><span>服务器竟然被挖矿程序攻击！？</span></a></div><div class="next-post pull-right"><a href="/2020/07/18/Gulp/"><span>Gulp</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = 'true' == true ? true : false;
var verify = 'true' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'YiMuUS8mJ9iQH4i0HKdegAjN-gzGzoHsz',
  appKey:'S42xmXqdEnhtc3ibq7F71WYu',
  placeholder:'Just go go',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'5',
  lang: 'zh-cn'
})</script></div></div><footer class="footer-bg" style="background-image: url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1606218892799&amp;di=ab820794d4e4cdd390b3a7a2d01c0cc7&amp;imgtype=0&amp;src=http%3A%2F%2Fattachments.gfan.com%2Fforum%2F201504%2F06%2F0638202b7ws2d2w4bzsyuu.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2021 By XYX</div><div class="framework-info"></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span></span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;"></a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>